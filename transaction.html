<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商場交易數據分析儀</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- SheetJS for Excel processing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <!-- Prop Types (Required for Recharts UMD stability) -->
    <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    
    <!-- Recharts for Charts (Pinned to stable version 2.12.7) -->
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>

    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        .drag-active { border-color: #3b82f6; background-color: #eff6ff; }
        .loader {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, Cell } = window.Recharts || {};

        // --- Constants ---
        const PAYMENT_OPTIONS = [
            "中信收單", "聯信收單", "現金", "101 Pay中信", "101 Pay台新",
            "LINE PAY", "街口錢包", "宜睿", "台灣PAY(被)", "微信支付",
            "元大支付寶", "悠遊卡", "悠遊卡-停車", "購物金",
            "新電子商品禮券", "銀聯UPLAN"
        ];
        
        const CARD_TYPE_OPTIONS = ["VISA", "MASTER", "A/E"];
        const ITEMS_PER_PAGE = 100;

        // --- Icon Components ---
        const Icon = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const CheckCircleIcon = ({ className }) => (
            <Icon className={className}>
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </Icon>
        );

        const XCircleIcon = ({ className }) => (
            <Icon className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
            </Icon>
        );

        const ChartIcon = ({ className }) => (
            <Icon className={className}>
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
            </Icon>
        );

        const UploadCloudIcon = ({ className }) => (
            <Icon className={className}>
                <path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path>
                <path d="M12 12v9"></path>
                <path d="m16 16-4-4-4 4"></path>
            </Icon>
        );

        const AlertCircleIcon = ({ className }) => (
            <Icon className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </Icon>
        );

        const CalendarIcon = ({ className }) => (
            <Icon className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </Icon>
        );

        const CreditCardIcon = ({ className }) => (
            <Icon className={className}>
                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                <line x1="1" y1="10" x2="23" y2="10"></line>
            </Icon>
        );

        const ClockIcon = ({ className }) => (
            <Icon className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </Icon>
        );
        
        const SearchIcon = ({ className }) => (
            <Icon className={className}>
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </Icon>
        );

        // --- Helper Functions ---

        const normalizeStr = (str) => {
            if (!str) return "";
            return String(str).replace(/[\s\r\n\t\uFEFF\x00-\x1F]/g, "").toLowerCase();
        };

        const findColumnIndex = (headers, keywords) => {
            return headers.findIndex(header => {
                const normalized = normalizeStr(header);
                return keywords.some(keyword => normalized.includes(keyword));
            });
        };

        const formatExcelDate = (val) => {
            if (!val) return "";
            if (typeof val === 'number') {
                const date = new Date(Math.round((val - 25569) * 86400 * 1000));
                const year = date.getUTCFullYear();
                const month = String(date.getUTCMonth() + 1).padStart(2, '0');
                const day = String(date.getUTCDate()).padStart(2, '0');
                return `${year}/${month}/${day}`;
            }
            const strVal = String(val).trim();
            if (strVal.match(/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/)) return strVal;
            return strVal;
        };

        const getHour = (timeVal) => {
            if (!timeVal && timeVal !== 0) return -1;
            if (typeof timeVal === 'number') {
                if (timeVal < 1) return Math.floor((timeVal * 24) + 0.0001); 
                if (timeVal >= 0 && timeVal <= 2400) return Math.floor(timeVal / 100);
            }
            const str = String(timeVal).trim();
            const matchColon = str.match(/(\d{1,2}):\d{2}/);
            if (matchColon) return parseInt(matchColon[1], 10);
            if (/^\d{3,4}$/.test(str)) return Math.floor(parseInt(str, 10) / 100);
            return -1;
        };

        const formatTime = (timeVal) => {
             if (timeVal === null || timeVal === undefined) return "";
             if (typeof timeVal === 'number' && timeVal < 1) {
                 const totalSeconds = Math.floor(timeVal * 86400);
                 const h = Math.floor(totalSeconds / 3600);
                 const m = Math.floor((totalSeconds % 3600) / 60);
                 return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
             }
             if (/^\d{3,4}$/.test(String(timeVal))) {
                 const s = String(timeVal).padStart(4, '0');
                 return `${s.substring(0,2)}:${s.substring(2,4)}`;
             }
             return String(timeVal);
        };

        // --- Main Component ---

        const App = () => {
            const [fileData, setFileData] = useState(null);
            const [analysis, setAnalysis] = useState(null);
            const [transactions, setTransactions] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [dragActive, setDragActive] = useState(false);

            const [filters, setFilters] = useState({ posId: "", paymentType: "", cardType: "" });
            const [searchResults, setSearchResults] = useState(null);
            const [currentPage, setCurrentPage] = useState(1);

            const processExcel = async (file) => {
                setLoading(true);
                setError(null);
                const reader = new FileReader();

                reader.onload = (e) => {
                    try {
                        const data = e.target.result;
                        const workbook = XLSX.read(data, { type: 'binary' });
                        const sheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });

                        if (jsonData.length < 2) throw new Error("檔案內容過少");

                        let headerRowIndex = -1;
                        let tenantColIdx = -1, paymentColIdx = -1, timeColIdx = -1;
                        let dateColIdx = -1, posColIdx = -1, amountColIdx = -1, cardTypeColIdx = -1;

                        for (let i = 0; i < Math.min(jsonData.length, 15); i++) {
                            const row = jsonData[i];
                            const tIdx = findColumnIndex(row, ['租戶', '專櫃', 'tenant']);
                            const pIdx = findColumnIndex(row, ['支付', '付款', 'payment']);
                            if (tIdx !== -1 && pIdx !== -1) {
                                headerRowIndex = i;
                                tenantColIdx = tIdx;
                                paymentColIdx = pIdx;
                                timeColIdx = findColumnIndex(row, ['時間', 'time', '交易時']);
                                dateColIdx = findColumnIndex(row, ['日期', 'date', '銷售日']);
                                posColIdx = findColumnIndex(row, ['收銀機', 'pos', '機號']);
                                amountColIdx = findColumnIndex(row, ['金額', 'amount', 'price']);
                                cardTypeColIdx = findColumnIndex(row, ['信用卡類別', 'card type', '卡別']);
                                break;
                            }
                        }

                        if (headerRowIndex === -1) throw new Error("無法識別標題列");

                        const rawData = jsonData.slice(headerRowIndex + 1);
                        const stats = {
                            totalTransactions: 0,
                            paymentTypes: {}, // Existing payment counts
                            hourlyData: Array(24).fill(0).map((_, i) => ({ 
                                hour: `${String(i).padStart(2, '0')}:00`, building: 0, mall: 0, total: 0 
                            }))
                        };
                        
                        const parsedTransactions = [];

                        rawData.forEach((row, index) => {
                            if (!row || row.length === 0) return;
                            const tenantId = normalizeStr(row[tenantColIdx]).toUpperCase();
                            const paymentType = String(row[paymentColIdx]).trim();
                            if (!tenantId && !paymentType) return;
                            if (tenantId.includes('共') && tenantId.includes('筆')) return;

                            stats.totalTransactions++;
                            if (paymentType) {
                                stats.paymentTypes[paymentType] = (stats.paymentTypes[paymentType] || 0) + 1;
                            }

                            const hour = getHour(row[timeColIdx]);
                            if (hour >= 0 && hour < 24) {
                                if (tenantId.startsWith('T')) stats.hourlyData[hour].building++;
                                else stats.hourlyData[hour].mall++;
                                stats.hourlyData[hour].total++;
                            }

                            parsedTransactions.push({
                                id: index,
                                date: dateColIdx !== -1 ? formatExcelDate(row[dateColIdx]) : "",
                                time: formatTime(row[timeColIdx]),
                                posId: posColIdx !== -1 ? String(row[posColIdx]).trim() : "",
                                tenant: row[tenantColIdx],
                                paymentType: paymentType,
                                amount: amountColIdx !== -1 ? row[amountColIdx] : 0,
                                cardType: cardTypeColIdx !== -1 ? String(row[cardTypeColIdx]).trim() : ""
                            });
                        });

                        setTransactions(parsedTransactions);
                        setAnalysis({
                            dateRange: jsonData[1] ? String(jsonData[1]).substring(0,20) : "未知",
                            generatedAt: new Date().toLocaleString(),
                            stats
                        });
                        setFileData({ name: file.name });
                        setSearchResults(null);
                    } catch (err) {
                        setError(err.message);
                    } finally {
                        setLoading(false);
                    }
                };
                reader.readAsBinaryString(file);
            };

            const performSearch = () => {
                const results = transactions.filter(t => {
                    if (filters.posId && !t.posId.toLowerCase().includes(filters.posId.toLowerCase())) return false;
                    if (filters.paymentType && t.paymentType !== filters.paymentType) return false;
                    if (filters.cardType && !t.cardType.toUpperCase().includes(filters.cardType)) return false;
                    return true;
                });
                setSearchResults(results);
                setCurrentPage(1);
            };

            const paginatedResults = useMemo(() => {
                if (!searchResults) return [];
                return searchResults.slice((currentPage - 1) * ITEMS_PER_PAGE, currentPage * ITEMS_PER_PAGE);
            }, [searchResults, currentPage]);

            // --- Render Logic ---

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-7xl mx-auto pb-20">
                    <div className="mb-8 text-center">
                        <h1 className="text-3xl font-bold text-gray-800 flex items-center justify-center gap-2">
                            <ChartIcon className="w-8 h-8 text-blue-600" />
                            商場交易數據分析儀
                        </h1>
                    </div>

                    {!analysis && (
                        <div 
                            className={`relative border-2 border-dashed rounded-xl p-12 text-center transition-all bg-white shadow-sm ${dragActive ? "border-blue-500 bg-blue-50" : "border-gray-300"}`}
                            onDragOver={(e) => { e.preventDefault(); setDragActive(true); }}
                            onDragLeave={() => setDragActive(false)}
                            onDrop={(e) => { e.preventDefault(); setDragActive(false); processExcel(e.dataTransfer.files[0]); }}
                        >
                            <input type="file" className="absolute inset-0 w-full h-full opacity-0 cursor-pointer" onChange={(e) => processExcel(e.target.files[0])} />
                            {loading ? <div className="loader mx-auto"></div> : <UploadCloudIcon className="w-16 h-16 text-gray-400 mx-auto mb-4" />}
                            <p className="text-xl font-medium text-gray-700">拖放 Excel 檔案開始分析</p>
                        </div>
                    )}

                    {analysis && (
                        <div className="space-y-8 animate-fade-in">
                            {/* Summary Header */}
                            <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col md:flex-row justify-between border border-gray-100">
                                <div>
                                    <h2 className="text-xl font-bold text-gray-800">分析報告：{fileData.name}</h2>
                                    <p className="text-gray-500 text-sm mt-1">產生於 {analysis.generatedAt}</p>
                                </div>
                                <button onClick={() => window.location.reload()} className="mt-4 md:mt-0 text-blue-600 hover:underline">重新上傳</button>
                            </div>

                            {/* Payment Audit & Stats Section */}
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                {/* Left: Payment Checklist & Count */}
                                <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex flex-col">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2">
                                            <CreditCardIcon className="w-5 h-5 text-purple-500" />
                                            支付項核查與統計
                                        </h3>
                                        <span className="text-xs text-gray-400">依據定義選單核對資料</span>
                                    </div>
                                    <div className="flex-1 overflow-y-auto max-h-[400px] custom-scrollbar pr-2">
                                        <div className="space-y-3">
                                            {PAYMENT_OPTIONS.map(option => {
                                                const count = analysis.stats.paymentTypes[option] || 0;
                                                const hasData = count > 0;
                                                return (
                                                    <div key={option} className={`flex items-center justify-between p-3 rounded-lg border transition-all ${hasData ? 'border-green-100 bg-green-50/30' : 'border-gray-100 bg-gray-50/50'}`}>
                                                        <div className="flex items-center gap-3">
                                                            {hasData ? <CheckCircleIcon className="text-green-500" /> : <XCircleIcon className="text-gray-300" />}
                                                            <span className={`font-medium ${hasData ? 'text-gray-800' : 'text-gray-400'}`}>{option}</span>
                                                        </div>
                                                        <div className="text-right">
                                                            <div className={`font-bold ${hasData ? 'text-blue-600' : 'text-gray-300'}`}>{count.toLocaleString()} <span className="text-xs font-normal">筆</span></div>
                                                            {hasData && (
                                                                <div className="text-[10px] text-gray-400">
                                                                    佔比 {((count / analysis.stats.totalTransactions) * 100).toFixed(1)}%
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                            {/* Show others not in preset list */}
                                            {Object.keys(analysis.stats.paymentTypes)
                                                .filter(k => !PAYMENT_OPTIONS.includes(k))
                                                .map(k => (
                                                    <div key={k} className="flex items-center justify-between p-3 rounded-lg border border-yellow-100 bg-yellow-50/30">
                                                        <div className="flex items-center gap-3">
                                                            <AlertCircleIcon className="text-yellow-500 w-5 h-5" />
                                                            <span className="font-medium text-gray-800">{k} <small className="text-yellow-600">(未定義)</small></span>
                                                        </div>
                                                        <div className="font-bold text-blue-600">{analysis.stats.paymentTypes[k].toLocaleString()} <span className="text-xs font-normal">筆</span></div>
                                                    </div>
                                                ))
                                            }
                                        </div>
                                    </div>
                                </div>

                                {/* Right: Visualized Breakdown */}
                                <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100 flex flex-col">
                                    <h3 className="text-lg font-bold text-gray-800 mb-6 flex items-center gap-2">
                                        <ChartIcon className="w-5 h-5 text-blue-500" />
                                        交易佔比視覺化
                                    </h3>
                                    <div className="space-y-6">
                                        {Object.entries(analysis.stats.paymentTypes)
                                            .sort(([,a], [,b]) => b - a)
                                            .slice(0, 8) // Top 8 for visual clarity
                                            .map(([type, count]) => {
                                                const percent = (count / analysis.stats.totalTransactions) * 100;
                                                return (
                                                    <div key={type}>
                                                        <div className="flex justify-between text-sm mb-1">
                                                            <span className="text-gray-700 font-medium">{type}</span>
                                                            <span className="text-gray-500">{percent.toFixed(1)}%</span>
                                                        </div>
                                                        <div className="w-full bg-gray-100 rounded-full h-2">
                                                            <div className="bg-blue-500 h-2 rounded-full transition-all duration-1000" style={{ width: `${percent}%` }}></div>
                                                        </div>
                                                    </div>
                                                );
                                            })
                                        }
                                        {Object.keys(analysis.stats.paymentTypes).length > 8 && (
                                            <p className="text-center text-xs text-gray-400 italic">僅顯示前 8 名支付方式</p>
                                        )}
                                    </div>
                                    
                                    <div className="mt-auto pt-8">
                                        <div className="p-4 bg-gray-50 rounded-lg border border-gray-200">
                                            <div className="text-center">
                                                <div className="text-3xl font-black text-gray-800">{analysis.stats.totalTransactions.toLocaleString()}</div>
                                                <div className="text-xs text-gray-500 uppercase tracking-widest mt-1">總交易筆數</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Hourly Flow Chart */}
                            <div className="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
                                <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <ClockIcon className="w-5 h-5 text-orange-500" />
                                    時段交易分佈
                                </h3>
                                <div className="h-[300px] w-full">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <BarChart data={analysis.stats.hourlyData}>
                                            <CartesianGrid strokeDasharray="3 3" vertical={false} />
                                            <XAxis dataKey="hour" fontSize={12} />
                                            <YAxis />
                                            <Tooltip />
                                            <Legend />
                                            <Bar dataKey="building" name="大樓 (T)" stackId="a" fill="#3b82f6" />
                                            <Bar dataKey="mall" name="商場" stackId="a" fill="#f97316" />
                                        </BarChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>

                            {/* Search Section */}
                            <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                <div className="p-6 bg-gray-50 border-b border-gray-100">
                                    <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <SearchIcon className="w-5 h-5 text-blue-600" />
                                        交易明細查詢
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                                        <div>
                                            <label className="block text-xs font-bold text-gray-500 mb-1">POS 機號</label>
                                            <input type="text" className="w-full px-3 py-2 border rounded-md" value={filters.posId} onChange={e => setFilters({...filters, posId: e.target.value})} placeholder="例如: 010101" />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-bold text-gray-500 mb-1">付款別</label>
                                            <select className="w-full px-3 py-2 border rounded-md bg-white text-sm" value={filters.paymentType} onChange={e => setFilters({...filters, paymentType: e.target.value})}>
                                                <option value="">全部</option>
                                                {PAYMENT_OPTIONS.map(o => <option key={o} value={o}>{o}</option>)}
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-xs font-bold text-gray-500 mb-1">信用卡卡別</label>
                                            <select className="w-full px-3 py-2 border rounded-md bg-white text-sm" value={filters.cardType} onChange={e => setFilters({...filters, cardType: e.target.value})}>
                                                <option value="">全部</option>
                                                {CARD_TYPE_OPTIONS.map(o => <option key={o} value={o}>{o}</option>)}
                                            </select>
                                        </div>
                                        <button onClick={performSearch} className="bg-blue-600 text-white font-bold py-2 rounded-md hover:bg-blue-700 transition-colors">執行查詢</button>
                                    </div>
                                </div>

                                <div className="overflow-x-auto">
                                    <table className="w-full text-sm text-left">
                                        <thead className="bg-gray-50 text-gray-500 border-b">
                                            <tr>
                                                <th className="px-6 py-3">日期/時間</th>
                                                <th className="px-6 py-3">機號/租戶</th>
                                                <th className="px-6 py-3">付款方式</th>
                                                <th className="px-6 py-3 text-right">金額</th>
                                                <th className="px-6 py-3">卡別</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-100">
                                            {searchResults === null ? (
                                                <tr><td colSpan="5" className="py-12 text-center text-gray-400">請設定條件後按「執行查詢」</td></tr>
                                            ) : searchResults.length > 0 ? (
                                                paginatedResults.map(t => (
                                                    <tr key={t.id} className="hover:bg-blue-50/50">
                                                        <td className="px-6 py-3">
                                                            <div className="font-medium">{t.date}</div>
                                                            <div className="text-xs text-gray-400">{t.time}</div>
                                                        </td>
                                                        <td className="px-6 py-3">
                                                            <div className="font-mono text-blue-600">{t.posId}</div>
                                                            <div className="text-xs text-gray-500">{t.tenant}</div>
                                                        </td>
                                                        <td className="px-6 py-3 font-medium">{t.paymentType}</td>
                                                        <td className="px-6 py-3 text-right font-bold">${t.amount.toLocaleString()}</td>
                                                        <td className="px-6 py-3 text-gray-400 italic">{t.cardType || "-"}</td>
                                                    </tr>
                                                ))
                                            ) : (
                                                <tr><td colSpan="5" className="py-12 text-center text-gray-400 font-medium">查無符合條件的資料</td></tr>
                                            )}
                                        </tbody>
                                        {searchResults && searchResults.length > 0 && (
                                            <tfoot>
                                                <tr>
                                                    <td colSpan="5" className="px-6 py-3 bg-gray-50 border-t flex justify-between items-center">
                                                        <span className="text-xs text-gray-500">共 {searchResults.length} 筆資料</span>
                                                        <div className="flex gap-2">
                                                            <button disabled={currentPage === 1} onClick={() => setCurrentPage(p => p - 1)} className="px-3 py-1 border rounded text-xs disabled:opacity-30">上一頁</button>
                                                            <button disabled={currentPage * ITEMS_PER_PAGE >= searchResults.length} onClick={() => setCurrentPage(p => p + 1)} className="px-3 py-1 border rounded text-xs disabled:opacity-30">下一頁</button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tfoot>
                                        )}
                                    </table>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>